export TERM="xterm-256color"
export CARGO_HOME=~/.cargo
export GOPATH=/home/qupeng/.go
export PINGCAP_PATH=$GOPATH/src/github.com/pingcap

localbin=~/.local/bin
mavenbin=/opt/java-utils/maven-3.3.9/bin
antbin=/opt/java-utils/ant-1.9.7/bin
gradlebin=/opt/java-utils/gradle-3.2.1/bin
cargobin=$CARGO_HOME/bin
gobin=$GOPATH/bin
pingcap_bin=($HOME/.local/go/bin $PINGCAP_PATH/tidb/bin $PINGCAP_PATH/pd/bin $PINGCAP_PATH/tidb-tools/bin)

bins=($localbin $mavenbin $antbin $gradlebin $cargobin $gobin)
bins+=(${pingcap_bin[@]})
mypath=""
for bin in ${bins[@]}; do
	if [ ! `echo $PATH|grep $bin` ]; then
		if [[ -d $bin ]]; then
			mypath=$mypath:$bin
		fi
	fi
done
export PATH=$mypath:$PATH

### key maps and alias
bindkey '^_[[Z' reverse-menu-complete
alias rm="rm -i"
alias ls="ls -h --color=auto"
alias ll="ls -l"
alias cc="clear"
alias gg="exit"
alias vi="vim"
alias sc="systemctl"
alias scu="systemctl --user"
alias gst="git status"
alias gbv="git branch -v"
alias gd="git diff"
alias gdn="git diff --name-only"
alias gdt="git difftool"
alias gdtn="git difftool --name-only"
eval `dircolors ~/.dircolors`

fg() {
	if [ $# -eq 1 && $1 == - ]; then
		builtin fg %-
	else
		builtin fg %"$@"
	fi
}

bg() {
	if [ $# -eq 1 && $1 == - ]; then
		builtin bg %-
	else
		builtin bg %"$@"
	fi
}

if [ ! `echo $LD_LIBRARY_PATH | grep "/usr/local"` ]; then
    export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
    export LIBRARY_PATH=/usr/local/lib:$LIBRARY_PATH
fi

if [ ! `echo $LD_LIBRARY_PATH | grep -E "\.local"` ]; then
    export LD_LIBRARY_PATH=~/.local/lib:$LD_LIBRARY_PATH
    export LIBRARY_PATH=~/.local/lib:$LIBRARY_PATH
fi

# for rust
if [ ! `echo $LD_LIBRARY_PATH | grep "rustup"` ]; then
    rust_root=$(rustc --print sysroot)
    export LD_LIBRARY_PATH=$rust_root/lib:$LD_LIBRARY_PATH
    export LIBRARY_PATH=$rust_root/lib:$LD_LIBRARY_PATH
fi

# for go
gopath=/usr/local/go/bin
if [ ! `echo $PATH|grep $gopath` ]; then
	export PATH=$PATH:$gopath
fi

### oh-my-zsh
ZSH=~/.oh-my-zsh
ZSH_THEME="qupeng"
DISABLE_AUTO_UPDATE="true"
CASE_SENSITIVE="true"
plugins=(rust rustup cargo pip git)

ZSH_CACHE_DIR=$HOME/.oh-my-zsh-cache
[[ ! -d $ZSH_CACHE_DIR ]] && mkdir $ZSH_CACHE_DIR

source $ZSH/oh-my-zsh.sh
unsetopt AUTO_CD  # disable auto_cd when type dirname

autoload -U compinit
compinit
