# terminal settings.
export TERM="xterm-256color"
eval `dircolors ~/.dircolors`

# oh-my-zsh
ZSH=~/.oh-my-zsh
ZSH_THEME="qupeng"
DISABLE_AUTO_UPDATE="true"
CASE_SENSITIVE="true"
plugins=(rust rustup cargo pip git)

ZSH_CACHE_DIR=$HOME/.oh-my-zsh-cache
[[ ! -d $ZSH_CACHE_DIR ]] && mkdir $ZSH_CACHE_DIR

source $ZSH/oh-my-zsh.sh
unsetopt AUTO_CD  # disable auto_cd when type dirname

autoload -U compinit
compinit

# key maps and alias
bindkey '^_[[Z' reverse-menu-complete
alias rm="rm -i"
alias ls="ls -h --color=auto"
alias ll="ls -l"
alias cc="clear"
alias gg="exit"
alias vi="vim"
alias sc="systemctl"
alias scu="systemctl --user"
alias gst="git status"
alias gbv="git branch -v"
alias gd="git diff"
alias gdn="git diff --name-only"
alias gdt="git difftool"
alias gdtn="git difftool --name-only"

# dev settings.
export CARGO_HOME=~/.cargo
export GOPATH=/home/qupeng/.go

# for rust
export RUST_ROOT=$(rustc --print sysroot)
export RUST_SRC_PATH=$RUST_ROOT/lib/rustlib/src/rust/src
if [ ! `echo $LD_LIBRARY_PATH | grep $RUST_ROOT` ]; then
    export LD_LIBRARY_PATH=$RUST_ROOT/lib:$LD_LIBRARY_PATH
    export LIBRARY_PATH=$RUST_ROOT/lib:$LIBRARY_PATH
fi

localbin=~/.local/bin
cargobin=$CARGO_HOME/bin
rustbin=$RUST_ROOT/bin
gobin=$GOPATH/bin

bins=($localbin $cargobin $rustbin $gobin /home/qupeng/.local/opt/go/bin)
mypath=""
for bin in ${bins[@]}; do
	if [ ! `echo $PATH|grep $bin` ]; then
		if [[ -d $bin ]]; then
			mypath=$mypath:$bin
		fi
	fi
done
export PATH=$mypath:$PATH

if [ ! `echo $LD_LIBRARY_PATH | grep "/usr/local"` ]; then
    export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
    export LIBRARY_PATH=/usr/local/lib:$LIBRARY_PATH
fi

if [ ! `echo $LD_LIBRARY_PATH | grep -E "\.local"` ]; then
    export LD_LIBRARY_PATH=~/.local/lib:$LD_LIBRARY_PATH
    export LIBRARY_PATH=~/.local/lib:$LIBRARY_PATH
    export C_INCLUDE_PATH=~/.local/include:$C_INCLUDE_PATH
fi

if [ ! `echo $MANPATH | grep -E "\.local"` ] ;then
    export MANPATH=~/.local/share/man:$MANPATH
fi

fg() {
	if [ $# -eq 1 && $1 == - ]; then
		builtin fg %-
	else
		builtin fg %"$@"
	fi
}

bg() {
	if [ $# -eq 1 && $1 == - ]; then
		builtin bg %-
	else
		builtin bg %"$@"
	fi
}
